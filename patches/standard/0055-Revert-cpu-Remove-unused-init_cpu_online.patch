From f5ea3d6057f8fed2c4a18a8ca5710f3f9514e1e5 Mon Sep 17 00:00:00 2001
From: Johnny Mnemonic <jm@machine-hall.org>
Date: Mon, 27 Jan 2025 15:44:13 +0100
Subject: [PATCH 055/101] Revert "cpu: Remove unused init_cpu_online"

This reverts commit 7f15d4abf925f33015fb62973ce2ddb45ce04bb9.
---
 include/linux/cpumask.h | 1 +
 kernel/cpu.c            | 5 +++++
 2 files changed, 6 insertions(+)

diff --git a/include/linux/cpumask.h b/include/linux/cpumask.h
index 80211900f373..422c254d3df0 100644
--- a/include/linux/cpumask.h
+++ b/include/linux/cpumask.h
@@ -1150,6 +1150,7 @@ extern const DECLARE_BITMAP(cpu_all_bits, NR_CPUS);
 /* Wrappers for arch boot code to manipulate normally-constant masks */
 void init_cpu_present(const struct cpumask *src);
 void init_cpu_possible(const struct cpumask *src);
+void init_cpu_online(const struct cpumask *src);
 
 #define assign_cpu(cpu, mask, val)	\
 	assign_bit(cpumask_check(cpu), cpumask_bits(mask), (val))
diff --git a/kernel/cpu.c b/kernel/cpu.c
index 81a0c2ba27d2..58bda1284ef8 100644
--- a/kernel/cpu.c
+++ b/kernel/cpu.c
@@ -3121,6 +3121,11 @@ void init_cpu_possible(const struct cpumask *src)
 	__num_possible_cpus = cpumask_weight(&__cpu_possible_mask);
 }
 
+void init_cpu_online(const struct cpumask *src)
+{
+	cpumask_copy(&__cpu_online_mask, src);
+}
+
 void set_cpu_online(unsigned int cpu, bool online)
 {
 	/*
-- 
2.25.1

